# Enable rewrite engine
RewriteEngine On
Options +FollowSymLinks

# Set default character set
AddDefaultCharset UTF-8

# Security headers
Header set X-Content-Type-Options "nosniff"
Header set X-Frame-Options "SAMEORIGIN"
Header set X-XSS-Protection "1; mode=block"

# Set default index files
DirectoryIndex index.php index.html

# Deny access to hidden files and directories
<Files ".*">
    Require all denied
</Files>

# Protect logs directory
<Files ~ "^logs/.*\.log$">
    Require all denied
</Files>

# If the request is for an actual file or directory, serve it directly
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# Handle API requests - pass through to api/.htaccess
RewriteRule ^api/ - [L]

# Ensure proper handling of JSON responses
AddType application/json .json
