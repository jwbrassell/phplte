# Basic Apache settings
Options +FollowSymLinks
DirectoryIndex index.php index.html

# Enable rewrite engine
RewriteEngine On

# Security headers
Header set X-Content-Type-Options "nosniff"
Header set X-Frame-Options "SAMEORIGIN"
Header set X-XSS-Protection "1; mode=block"

# File protection
<FilesMatch "^\.(?!htaccess)">
    Require all denied
</FilesMatch>
<FilesMatch "^logs/.*\.log$">
    Require all denied
</FilesMatch>

# Rewrite rules
# 1. If the file/directory exists, serve it directly
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# 2. API passthrough
RewriteRule ^api/ - [L]

# 3. All other requests go to PHP files
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d 
RewriteCond %{REQUEST_URI} !\.php$
RewriteRule ^([^/]+)/?$ $1.php [L]

# Content types
AddDefaultCharset UTF-8
AddType application/json .json
